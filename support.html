---
layout: default
---
<style>
    .yes {
        background-color: rgba(0, 255, 0, 0.2);
    }

    .some {
        background-color: rgba(194, 194, 0, 0.2);
    }

    .no {
        background-color: rgba(255, 0, 0, 0.2);
    }
</style>

<h1>Card support</h1>

<h2>$ \mathbb{F}_p $</h2>

<table>
    <colgroup>
        <col span="1" style="width: 12%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
    </colgroup>
    <tr>
        <th></th>
        <th colspan="2">192b</th>
        <th colspan="2">256b</th>
        <th colspan="2">384b</th>
        <th colspan="2">521b</th>
    </tr>
    <tr>
        <th></th>
        <th>ECDH</th>
        <th>ECDSA</th>
        <th>ECDH</th>
        <th>ECDSA</th>
        <th>ECDH</th>
        <th>ECDSA</th>
        <th>ECDH</th>
        <th>ECDSA</th>
    </tr>
    <tr>
        <td><a href="{{ site.baseurl }}/results/default/Feitian_A22CR/">Feitian A22CR</a></td>
        <td class="some"></td>
        <td></td>
        <td class="some"></td>
        <td></td>
        <td class="some"></td>
        <td></td>
        <td class="some"></td>
        <td></td>
    </tr>
    <tr>
        <td><a href="{{ site.baseurl }}/results/default/GD_Smartcafe_6.0/">GD SmartCafe 6.0</a></td>
        <td class="yes">1,2,3,4<br/>128ms</td>
        <td class="yes">1,2,3,4,5<br/>270ms</td>
        <td class="yes">1,2,4,3<br/>190ms</td>
        <td class="yes">1,2,3,4,5<br/>355ms</td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
    </tr>
    <tr>
        <td><a href="{{ site.baseurl }}/results/default/JCOP31_v2.4.1/">JCOP31 v2.4.1</a></td>
        <td class="yes">1,2<br/>122ms</td>
        <td class="yes">1<br/>257ms</td>
        <td class="yes">1,2<br/>189ms</td>
        <td class="yes">1<br/>392ms</td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
    </tr>
    <tr>
        <td><a href="{{ site.baseurl }}/results/default/NXP_JCOP_CJ2A081/">NXP JCOP CJ2A081</a></td>
        <td class="yes">1,2<br/>75ms</td>
        <td class="yes">1<br/>151ms</td>
        <td class="yes">1,2<br/>123ms</td>
        <td class="yes">1<br/>241ms</td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
    </tr>
    <tr>
        <td><a href="{{ site.baseurl }}/results/default/NXP_JCOP_v2.4.2_R3/">NXP JCOP v2.4.2 R3</a></td>
        <td class="yes">1,2<br/>99ms</td>
        <td class="yes">1,2,3<br/>180ms</td>
        <td class="yes">1,2<br/>150ms</td>
        <td class="yes">1,2,3<br/>275ms</td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
    </tr>
</table>

<h2>$ \mathbb{F}_{2^m} $</h2>

<table>
    <colgroup>
        <col span="1" style="width: 12%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
        <col span="1" style="width: 10%">
    </colgroup>
    <tr>
        <th></th>
        <th colspan="2">163b</th>
        <th colspan="2">233b</th>
        <th colspan="2">283b</th>
        <th colspan="2">409b</th>
    </tr>
    <tr>
        <th></th>
        <th>ECDH</th>
        <th>ECDSA</th>
        <th>ECDH</th>
        <th>ECDSA</th>
        <th>ECDH</th>
        <th>ECDSA</th>
        <th>ECDH</th>
        <th>ECDSA</th>
    </tr>
    <tr>
        <td><a href="{{ site.baseurl }}/results/default/Feitian_A22CR/">Feitian A22CR</a></td>
        <td class="some"></td>
        <td></td>
        <td class="some"></td>
        <td></td>
        <td class="some"></td>
        <td></td>
        <td class="some"></td>
        <td></td>
    </tr>
    <tr>
        <td><a href="{{ site.baseurl }}/results/default/GD_Smartcafe_6.0/">GD SmartCafe 6.0</a></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
    </tr>
    <tr>
        <td><a href="{{ site.baseurl }}/results/default/JCOP31_v2.4.1/">JCOP31 v2.4.1</a></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
    </tr>
    <tr>
        <td><a href="{{ site.baseurl }}/results/default/NXP_JCOP_CJ2A081/">NXP JCOP CJ2A081</a></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
    </tr>
    <tr>
        <td><a href="{{ site.baseurl }}/results/default/NXP_JCOP_v2.4.2_R3/">NXP JCOP v2.4.2 R3</a></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
        <td class="no"></td>
    </tr>
</table>

<h2>Legend</h2>
<br/>
<div style="float:left">
    *ECDH types
    <ul>
        <li>1 - ALG_EC_SVDP_DH</li>
        <li>2 - ALG_EC_SVDP_DHC</li>
        <li>3 - ALG_EC_SVDP_DH_PLAIN</li>
        <li>4 - ALG_EC_SVDP_DHC_PLAIN</li>
        <li>5 - ALG_EC_PACE_GM</li>
        <li>6 - ALG_EC_SVDP_DH_PLAIN_XY</li>
    </ul>
</div>
<div style="float:left">
    *ECDSA types
    <ul>
        <li>1 - ALG_ECDSA_SHA</li>
        <li>2 - ALG_ECDSA_SHA_224</li>
        <li>3 - ALG_ECDSA_SHA_256</li>
        <li>4 - ALG_ECDSA_SHA_384</li>
        <li>5 - ALG_ECDSA_SHA_512</li>
    </ul>
</div>
<div style="clear:both"></div>

<h2>Implementation guide</h2>
A basic example of EC KeyPair generation is visible below, for a more complete example see <a href="{{ site.baseurl}}/assets/ECExample.java">ECExample.java</a>.
<pre>
    <code class="java">
    // secp256r1 from http://www.secg.org/sec2-v2.pdf
    byte[] EC256_FP_P = new byte[]{
            (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x01,
            (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00,
            (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF,
            (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF};
    byte[] EC256_FP_A = new byte[]{
            (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x01,
            (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00,
            (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF,
            (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFC};
    byte[] EC256_FP_B = new byte[]{
            (byte) 0x5A, (byte) 0xC6, (byte) 0x35, (byte) 0xD8, (byte) 0xAA, (byte) 0x3A, (byte) 0x93, (byte) 0xE7,
            (byte) 0xB3, (byte) 0xEB, (byte) 0xBD, (byte) 0x55, (byte) 0x76, (byte) 0x98, (byte) 0x86, (byte) 0xBC,
            (byte) 0x65, (byte) 0x1D, (byte) 0x06, (byte) 0xB0, (byte) 0xCC, (byte) 0x53, (byte) 0xB0, (byte) 0xF6,
            (byte) 0x3B, (byte) 0xCE, (byte) 0x3C, (byte) 0x3E, (byte) 0x27, (byte) 0xD2, (byte) 0x60, (byte) 0x4B};
    byte[] EC256_FP_G = new byte[]{
            (byte) 0x04,
            (byte) 0x6B, (byte) 0x17, (byte) 0xD1, (byte) 0xF2, (byte) 0xE1, (byte) 0x2C, (byte) 0x42, (byte) 0x47,
            (byte) 0xF8, (byte) 0xBC, (byte) 0xE6, (byte) 0xE5, (byte) 0x63, (byte) 0xA4, (byte) 0x40, (byte) 0xF2,
            (byte) 0x77, (byte) 0x03, (byte) 0x7D, (byte) 0x81, (byte) 0x2D, (byte) 0xEB, (byte) 0x33, (byte) 0xA0,
            (byte) 0xF4, (byte) 0xA1, (byte) 0x39, (byte) 0x45, (byte) 0xD8, (byte) 0x98, (byte) 0xC2, (byte) 0x96,
            (byte) 0x4F, (byte) 0xE3, (byte) 0x42, (byte) 0xE2, (byte) 0xFE, (byte) 0x1A, (byte) 0x7F, (byte) 0x9B,
            (byte) 0x8E, (byte) 0xE7, (byte) 0xEB, (byte) 0x4A, (byte) 0x7C, (byte) 0x0F, (byte) 0x9E, (byte) 0x16,
            (byte) 0x2B, (byte) 0xCE, (byte) 0x33, (byte) 0x57, (byte) 0x6B, (byte) 0x31, (byte) 0x5E, (byte) 0xCE,
            (byte) 0xCB, (byte) 0xB6, (byte) 0x40, (byte) 0x68, (byte) 0x37, (byte) 0xBF, (byte) 0x51, (byte) 0xF5};
    byte[] EC256_FP_R = new byte[]{
            (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00,
            (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF,
            (byte) 0xBC, (byte) 0xE6, (byte) 0xFA, (byte) 0xAD, (byte) 0xA7, (byte) 0x17, (byte) 0x9E, (byte) 0x84,
            (byte) 0xF3, (byte) 0xB9, (byte) 0xCA, (byte) 0xC2, (byte) 0xFC, (byte) 0x63, (byte) 0x25, (byte) 0x51};
    short EC256_FP_K = 1;

    // 1. Allocate the KeyPair object.
    KeyPair example = new KeyPair(KeyPair.ALG_EC_FP, (short) 256);

    // 2. If the key parts are not available, call genKeyPair.
    if (example.getPrivate() == null || example.getPublic() == null) {
        // Sometimes cards require this so we have the keyparts, to
        // set parameters on.
        try {
            example.genKeyPair();
        } catch (Exception ignored) {}
    }

    // 3. Get the key parts and set custom domain parameters on them.
    ECPrivateKey priv = (ECPrivateKey) example.getPrivate();
    ECPublicKey pub = (ECPublicKey) example.getPublic();

    priv.setFieldFP(EC256_FP_P, (short) 0, EC256_FP_P.length);
    pub.setFieldFP(EC256_FP_P, (short) 0, EC256_FP_P.length);

    priv.setA(EC256_FP_A, (short) 0, EC256_FP_A.length);
    pub.setA(EC256_FP_A, (short) 0, EC256_FP_A.length);

    priv.setB(EC256_FP_B, (short) 0, EC256_FP_B.length);
    pub.setB(EC256_FP_B, (short) 0, EC256_FP_B.length);

    priv.setG(EC256_FP_G, (short) 0, EC256_FP_G.length);
    pub.set(EC256_FP_G, (short) 0, EC256_FP_G.length);

    priv.setR(EC256_FP_R, (short) 0, EC256_FP_R.length);
    pub.setR(EC256_FP_R, (short) 0, EC256_FP_R.length);

    priv.setK(EC256_FP_K);
    pub.setK(EC256_FP_K);

    // 4. Generate the KeyPair over the custom set domain parameters.
    example.genKeyPair();
    // Now, the example keypair is ready for use.
    </code>
</pre>

<h2>Common pitfalls</h2>

<h3>No default curve</h3>

<h3>genKeyPair() behaviour</h3>

<h3>clearKey() behaviour</h3>