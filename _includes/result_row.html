
{% capture ok %}
{% if include.test.result.ok == true %}
<td align="center" class="tooltip cause-tooltip" data-cause="{{ include.test.result.cause }}"><i class="fa fa-check"></i></td>
{% else %}
<td align="center" class="tooltip cause-tooltip" data-cause="{{ include.test.result.cause }}"><i class="fa fa-exclamation-triangle"></i></td>
{% endif %}
{% endcapture %}

{% assign color_val=include.depth | minus: 1 | times: 10 %}
{% assign color_channel=255 | minus: color_val %}
{% assign color_red=color_channel %}
{% assign color_green=color_channel %}
{% assign color_blue=color_channel %}

{% if include.test.result.value == "ERROR" %}
	{% assign color_blue=color_blue | minus: 20 %}
	{% assign color_green=color_green | minus: 20 %}
{% elsif include.test.result.value == "FAILURE" or include.test.result.value == "UXSUCCESS" %}
	{% assign color_blue=color_blue | minus: 20 %}
{% else %}
	{% assign color_red=color_red | minus: 20 %}
	{% assign color_blue=color_blue | minus: 20 %}
{% endif %}
{% if color_red < 0 %}
	{% assign color_red=0 %}
{% endif %}
{% if color_green < 0 %}
	{% assign color_green=0 %}
{% endif %}
{% if color_blue < 0 %}
	{% assign color_blue=0 %}
{% endif %}
{% capture color %}background-color: rgb({{color_red}},{{color_green}},{{color_blue}});{% endcapture %}

{% capture hidden %}{% if include.depth > 1 %}display: none;{% endif %}{% endcapture %}

{% if include.test.type == "command" %}
	<tr class="test" data-depth="{{ include.depth }}" style="{{ hidden }}{{ color }}">
	    <td align="center" ><small>{{ include.depth }}</small></td>
	    {{ ok }}
	    <td>{{ include.test.desc }}</td>
	    <td class="tooltip sw-tooltip" data-natural-sw="'{{ include.test.response.natural_sw }}'" data-sws="'{{ include.test.response.sws | join: ',' }}'">{{ include.test.result.value }}</td>
	</tr>
{% elsif include.test.type == "compound" %}
	<tr class="test" data-depth="{{ include.depth }}" style="{{ hidden }}{{ color }}">
	    <td align="center" class="clickable" data-rows="{{ include.test.tests | size }}" data-toggled="false"><i class="fa fa-plus-square"></i></td>
	    {{ ok }}
	    <td><i class="fa fa-clone"></i> {{ include.test.desc }}</td>
	    <td>{{ include.test.result.value }}</td>
	</tr>
	{% for test in include.test.tests %}
		{% assign new_depth=include.depth | plus: 1 %}
	    {% include result_row.html test=test depth=new_depth %}
	{% endfor %}
{% elsif include.test.type == "key-pair-generator" %}
	<tr class="test" data-depth="{{ include.depth }}" style="{{ hidden }}{{ color }}">
		<td></td>
		{{ ok }}
		<td>{{ include.test.desc }}</td>
		<td class="tooltip kpg-tooltip" data-pubkey="{{ include.test.key-pair-generator.keypair.pubkey.raw }}" data-privkey="{{ include.test.key-pair-generator.keypair.privkey.raw }}">{{ include.test.result.value }}</td>
	</tr>
{% elsif include.test.type == "key-agreement" %}
	<tr class="test" data-depth="{{ include.depth }}" style="{{ hidden }}{{ color }}">
		<td></td>
		{{ ok }}
		<td>{{ include.test.desc }}</td>
		<td class="tooltip ka-tooltip" data-pubkey="{{ include.test.key-agreement.pubkey.raw }}" data-privkey="{{ include.test.key-agreement.privkey.raw }}" data-secret="{{ include.test.key-agreement.secret }}">{{ include.test.result.value }}</td>
	</tr>
{% elsif include.test.type == "signature" %}
	<tr class="test" data-depth="{{ include.depth }}" style="{{ hidden }}{{ color }}">
		<td></td>
		{{ ok }}
		<td>{{ include.test.desc }}</td>
		<td class="tooltip sig-tooltip" data-signature="{{ include.test.signature.raw }}">{{ include.test.result.value }}</td>
	</tr>
{% endif %}